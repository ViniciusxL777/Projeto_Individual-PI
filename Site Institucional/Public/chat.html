<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hueco Mundo | Bleach_Info</title>
    <link rel="stylesheet" href="styles/chat.css">
    <link rel="shortcut icon" href="assets/icons/Logo-ContornoSemFundo.png" type="image/x-icon">
</head>

<body onload="trazerTodosDebates()">

    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="navbar-logo">
            <img style="width: 140px; height: 140px;" src="assets/icons/Logo-ContornoSemFundo.png" alt="Logo">
        </div>
        <ul>
            <li><a href="index.html">Inicio</a></li>
            <select id="select_informacao" onchange="mudarPagina()">
                <option value="">Informações</option>
                <option value="sociedade_das_almas.html">Sociedade Das Almas</option>
                <option value="hoeco_mundo.html">Hoeco Mundo</option>
                <option value="sociedade_quincy.html">Sociedade Quincy</option>
                <option value="shinigami.html">Shinigami</option>
                <option value="hollow_arrancars.html">Hollow/Arrancars</option>
                <option value="quincy.html">Quincy</option>
            </select>
            <li><a href="quiz.html">Quiz</a></li>
            <li><a href="sobreNos.html">Sobre nós</a></li>
        </ul>
        <ul class="login"><img style="width: 100px; height: 100px;" src="assets/icons/Icone-Shinigami-SemFundo.png"
                alt="icone polus">
            <li>
                <a href="perfil.html">
                    <div id="nome"></div>
                </a>
            </li>
        </ul>
    </nav>

    <!-- CONTEÚDO -->
    <div class="conteudo">
        <div class="titulo_debate">
            <h1>Crie seus debates aqui!!!</h1>
            <div class="criarDebates">
                <h3>Digite o título do seu debate:</h3>
                <input type="text" id="input_criarDebate" class="input_criar">
                <button onclick="cadastrarDebate()">Cadastrar Debate</button>
            </div>
            <div id="geral">
                <!-- <div id="debateDados${idDebate[o - 1]}">
                    <div class="debate" id="${idDebate[o - 1]}">
                        <button onclick="trazerConteudoDebate()">
                            <p>Debate</p>
                        </button>
                    </div>
                    <div class="sub_titulo" id="">
                        <div class="texto-imagem">
                            <div class="texto">
                                <h2><button onclick="trazerConteudoDebate()">Titulo Debate</button></h2>
                                <div class="sub_conteudo" id="${debateEscolhido}">
                                    <div class="comentario">
                                        <div class="usuarioComentario" id="usuarioComentario">
                                            <p>ViniciusxL</p>
                                            <img src="assets/icons/Icone-Arrancara-SemFundo.png" alt="">
                                        </div>
                                        <div class="comentarioTexto">
                                            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Eos, cupiditate
                                                dolore
                                                corrupti
                                                perferendis provident suscipit consequuntur. Laudantium ut perspiciatis,
                                                veniam
                                                doloremque vitae, atque deleniti repudiandae illo vel, repellat optio
                                                obcaecati?
                                            </p>
                                        </div>
                                        <div class="imagens"><img
                                                src="assets/imgs/Quincy - Ataques De Flechas Espirituais.png" alt="">
                                        </div>
                                    </div>
                                    <div class="comentar">
                                        <div class="comentar">
                                            <p>Comentar:</p>
                                            <div class="comentarCampos">
                                                <input type="text" class="inputComentarTexto"
                                                    placeholder="Escreva seu comentário...">
                                                <label for="foto" class="comentarImagem">Escolher imagem</label>
                                                <input type="file" id="foto" class="inputComentarImagem" hidden>
                                            </div>
                                            <button>Enviar Comentário</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
    </div>

    <!-- RODAPÉ -->
    <footer>
        <div class="redirecionamento">
            <div class="link_footer">
                <h1>REDES SOCIAIS</h1>
                <div class="link">
                    <a href=""><img src="assets/icons/Icone-Instagram.png" alt="">@bleach_info_insta</a>
                    <a href=""><img src="assets/icons/Icone-Facebook.png" alt="">@bleach_infoface</a>
                    <a href=""><img src="assets/icons/Icone-YouTube.png" alt="">@bleachinfo_yt</a>
                </div>
            </div>
            <div class="link_footer">
                <h1>CONTATO</h1>
                <div class="link">
                    <a href=""><img src="assets/icons/Icone-Telefone.png" alt="">+55 11 930068513</a>
                    <a href=""><img src="assets/icons/Icone-Email.png" alt="">bleach_info@gmal.com</a>
                </div>
            </div>
            <div class="link_footer">
                <h1>MAPA DO SITE</h1>
                <div class="link2">
                    <a href="index.html">home<img class="img1" src="assets/icons/Icone-Link.png" alt=""></a>
                    <a href="login.html">informações<img class="img1" src="assets/icons/Icone-Link.png" alt=""></a>
                    <a href="login.html">Quiz<img class="img1" src="assets/icons/Icone-Link.png" alt=""></a>
                    <a href="sobreNos.html">Sobre Nós<img class="img1" src="assets/icons/Icone-Link.png" alt=""></a>
                </div>
            </div>
            <div class="link_footer">
                <h1>INFORMAÇÕES</h1>
                <div class="link2">
                    <a href="sociedade_das_almas.html">Sociedade das Almas<img class="img1"
                            src="assets/icons/Icone-Link.png" alt=""></a>
                    <a href="hoeco_mundo.html">Hoeco Mundo<img class="img1" src="assets/icons/Icone-Link.png"
                            alt=""></a>
                    <a href="sociedade_quincy.html">Sociedade Quincy<img class="img1" src="assets/icons/Icone-Link.png"
                            alt=""></a>
                    <a href="shinigami.html">Shinigami<img class="img1" src="assets/icons/Icone-Link.png" alt=""></a>
                    <a href="hollow_arrancara.html">Hollows/Arrancars<img class="img1" src="assets/icons/Icone-Link.png"
                            alt=""></a>
                    <a href="quincy.html">Quincy<img class="img1" src="assets/icons/Icone-Link.png" alt=""></a>
                </div>
            </div>
        </div>
        <div class="informacoes">
            <img src="assets/icons/Logo-ContornoSemFundo.png" alt="">
            <p>Copyright © 2025 | BLEACH_INFO</p>
            <p><img src="assets/icons/Icone-Brasil.png" alt="">Brasil Português</p>
        </div>
    </footer>
</body>

</html>
<script>
    var idUsuario = sessionStorage.ID_USUARIO
    var nomeUsuario = sessionStorage.NOME_USUARIO
    var email = sessionStorage.EMAIL_USUARIO
    var fotoPerfil = sessionStorage.IMAGEM_PERFIL
    nome.innerHTML = sessionStorage.NOME_USUARIO
    imagemPerfil.innerHTML = `<img style="width: 100px; height: 100px;" src="assets/fotosUsuario/${sessionStorage.IMAGEM_PERFIL}" alt="">`

    var todosDadosDebates = []
    var idDebate = []
    var titulo = []
    var DadosEspecificosDebates = []
    var debateEscolhido
    var tituloDebateEscolhido = ''

    var pkComentario = []
    var pkUsuario = []
    var nomeComentario = []
    var imagemPerfilComentario = []
    var comentario = []
    var imagemComentario = []

    function mudarPagina() {
        var select = select_informacao.value
        if (select !== "") {
            window.location.href = `${select}`
        }
    }

    function cadastrarDebate() {
        var tituloDebate = input_criarDebate.value
        if (tituloDebate == '') {
            alert(`Não pode cadastrar um debate vazio`)
        } else {
            fetch(`/chatRoute/cadastrarDebate`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    pkUsuarioServer: idUsuario,
                    tituloServer: tituloDebate
                })
            })
        }
    }

    function trazerTodosDebates() {
        fetch(`/chatRoute/trazerTodosDebates`, {
            method: "GET"
        })
            .then(response => response.json())
            .then(dadosDebates => {
                idDebate = []
                titulo = []
                todosDadosDebates = dadosDebates
                for (var i = 1; i <= todosDadosDebates.length; i++) {
                    idDebate.push(todosDadosDebates[i - 1].idDebate)
                    titulo.push(todosDadosDebates[i - 1].titulo)
                }
                geral.innerHTML = '';
                for (var o = 1; o <= idDebate.length; o++) {
                    geral.innerHTML += `
                <div id="debate_${idDebate[o - 1]}">
                    <div class="debate">
                        <button onclick="trazerConteudoDebate('debate_${idDebate[o - 1]}', ${o - 1})">
                            <p>${titulo[o - 1]}</p>
                        </button>
                    </div>
                </div>`
                }
            })
            .catch(error => {
                console.log("Erro ao carregar debates: " + error);
            });
    }

    function trazerConteudoDebate(idDiv, indiceDebate) {
        idDebate

        document.getElementById(idDiv).innerHTML = `
        <div class="sub_titulo">
            <div class="texto-imagem">
                <div class="texto">
                    <h2>${titulo[indiceDebate]}</h2>`

        function buscarDadosDebate() {
            fetch(`/chatRoute/buscarDadosDebate?idDebate=${idDiv}`, {
                method: "GET"
            })
                .then(response => response.json())
                .then(dadosDebate => {
                    DadosEspecificosDebates = dadosDebate
                    DadosEspecificosDebates.forEach(resposta => {
                        comentarioId.push(resposta.idComentario),
                            comentarioTexto.push(resposta.comentario),
                            comentarioImagem.push(resposta.imagem)
                    });
                })
        }



        document.getElementById(idDiv).innerHTML += `
                    <div class="sub_conteudo">
                        <div class="comentario">
                            <div class="usuarioComentario">
                                <p>ViniciusxL</p>
                                <img src="assets/icons/Icone-Arrancara-SemFundo.png" alt="">
                            </div>
                            <div class="comentarioTexto">
                                <p>Exemplo de comentário...</p>
                            </div>
                            <div class="imagens">
                                <img src="assets/imgs/Quincy - Ataques De Flechas Espirituais.png" alt="">
                            </div>
                        </div>
                        <div class="comentar">
                            <p>Comentar:</p>
                            <div class="comentarCampos">
                                <input type="text" class="inputComentarTexto" placeholder="Escreva seu comentário...">
                                <label for="foto_${idDebate[indiceDebate]}" class="comentarImagem">Escolher imagem</label>
                                <input type="file" id="foto_${idDebate[indiceDebate]}" class="inputComentarImagem" hidden>
                            </div>
                            <button>Enviar Comentário</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>`
    }

    function enviarComentario() {
        if (textoComentario.value == "" || foto.value == "") {
            alert(`Não é permitido comentario vazio`)
        } else {

            fetch(`/chatRoute/enviarComentarioTextoImagem`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    pkUsuarioServer: idUsuario,
                    comentarioTextoServe: textoComentario.value,
                    pkDebateServer: debateEscolhido
                })
            })

            const formData = new FormData()
            formData.append('foto', foto.files[0])
            formData.append('idUsuario', idUsuario)

            fetch("/chatRoute/enviarComentarioTextoImagem", {
                method: "POST",
                body: formData
            }).then(res => {
                console.log(res)
            }).catch(err => {
                console.log(erro)
            })
        }

    }

</script>